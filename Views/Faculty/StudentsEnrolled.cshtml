@model List<TutorLiveMentor.Models.Student>

@{
    var facultySubjects = ViewBag.Subjects as List<TutorLiveMentor.Models.AssignedSubject>;
    var enrolledStudents = Model;
    string selectedSubject = ViewBag.SelectedSubject as string;
}

<h2>Students Enrolled to You</h2>

<form method="get">
    <label for="subject">Select subject:</label>
    <select id="subject" name="subject" onchange="this.form.submit()" class="form-control" style="width: auto; display: inline-block;">
        <option value="">--Select Subject--</option>
        @if (facultySubjects != null)
        {
            foreach (var s in facultySubjects)
            {
                string sel = selectedSubject == s.Subject.Name ? "selected" : "";
                @:<option value="@s.Subject.Name" @sel>@s.Year - @s.Subject.Name (@s.SelectedCount students)</option>
            }
        }
    </select>
</form>

@if(enrolledStudents != null && enrolledStudents.Count > 0) {
    <div style="margin-top: 24px;">
        <h4>Students enrolled in @selectedSubject (@enrolledStudents.Count students)</h4>
        <table class="table table-striped table-bordered">
            <thead class="table-dark">
                <tr>
                    <th>S.No</th>
                    <th>Name of the Student</th>
                    <th>Registration Number</th>
                    <th>Year</th>
                    <th>Department</th>
                    <th>Email</th>
                </tr>
            </thead>
            <tbody>
                @{int serialNo = 1;}
                @foreach(var student in enrolledStudents) {
                    <tr>
                        <td>@serialNo</td>
                        <td>@student.FullName</td>
                        <td>@student.RegdNumber</td>
                        <td>@student.Year</td>
                        <td>@student.Department</td>
                        <td>@student.Email</td>
                    </tr>
                    serialNo++;
                }
            </tbody>
        </table>
    </div>
} else if(!string.IsNullOrEmpty(selectedSubject)) {
    <div class="alert alert-info" style="margin-top: 24px;">
        <h4>No students enrolled for @selectedSubject</h4>
        <p>Students haven't enrolled in this subject yet, or they may have unenrolled.</p>
    </div>
} else {
    <div class="alert alert-secondary" style="margin-top: 24px;">
        <p><strong>Select a subject above to view enrolled students.</strong></p>
        <p>You can see all students who have enrolled in your subjects.</p>
    </div>
}
